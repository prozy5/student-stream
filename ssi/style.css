const loader = document.getElementById("loader");
const site = document.getElementById("site");
const logo = document.getElementById("loader-logo");
const text = document.getElementById("loader-text");
const authModal = document.getElementById("authModal");
const agentStatus = document.getElementById("agentStatus");

// LOADING SEQUENCE
window.addEventListener("load", () => {

  setTimeout(() => {
    logo.classList.add("show");
    text.textContent = "Authenticating identity…";
  }, 600);

  setTimeout(() => {
    text.textContent = "Accessing investigation database…";
  }, 1400);

  setTimeout(() => {
    text.textContent = "Access granted.";
  }, 2200);

  setTimeout(() => {
    loader.style.display = "none";
    site.classList.remove("hidden");
    checkLogin();
  }, 3000);

});

// LOGIN SYSTEM
function login() {
  const user = document.getElementById("username").value || "Guest Agent";
  localStorage.setItem("ssi_agent", user);
  closeAuth();
  updateAgent();
}

function closeAuth() {
  authModal.classList.add("hidden");
}

function checkLogin() {
  const agent = localStorage.getItem("ssi_agent");
  if (!agent) {
    authModal.classList.remove("hidden");
  } else {
    updateAgent();
  }
}

function updateAgent() {
  const agent = localStorage.getItem("ssi_agent");
  if (agent) {
    agentStatus.textContent = `Logged in as Agent: ${agent}`;
  } else {
    agentStatus.textContent = "Operating as Guest";
  }
}