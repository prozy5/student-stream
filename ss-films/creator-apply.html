<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Become a Creator â€“ SS Films</title>

<style>
body{
  margin:0;
  background:#0b0f14;
  color:#fff;
  font-family:system-ui,-apple-system,sans-serif;
}

header{
  padding:14px;
  border-bottom:1px solid #1f2937;
  font-size:18px;
  font-weight:600;
}

.container{
  max-width:420px;
  margin:30px auto;
  padding:16px;
}

input,select,textarea{
  width:100%;
  margin-top:12px;
  padding:10px;
  border-radius:6px;
  border:none;
  background:#151b26;
  color:#fff;
  font-size:14px;
}

textarea{resize:none;height:90px}

button{
  margin-top:18px;
  width:100%;
  padding:12px;
  background:#1e90ff;
  border:none;
  border-radius:8px;
  color:#fff;
  font-weight:600;
  cursor:pointer;
}

.status{
  margin-top:12px;
  font-size:14px;
  opacity:.9;
}
</style>
</head>
<body>

<header>Become a Creator</header>

<div class="container">

  <p>Apply to upload films on SS Films.</p>

  <input id="name" placeholder="Creator / Channel Name">
  <input id="channel" placeholder="Channel URL (example: ss-films)">
  
  <select id="platform">
    <option value="">Select Platform</option>
    <option value="studio">Studio</option>
    <option value="independent">Independent</option>
    <option value="company">Company</option>
  </select>

  <textarea id="description" placeholder="Describe your content..."></textarea>

  <button onclick="apply()">Submit Application</button>

  <div class="status" id="status"></div>

</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabase = createClient(
  "https://iabzmoxzbqzcqgypxctr.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ"
);

async function getUser(){
  const { data:{user} } = await supabase.auth.getUser();
  return user;
}

window.apply = async () => {
  const status = document.getElementById("status");
  status.textContent = "";

  const user = await getUser();
  if(!user){
    status.textContent = "You must be logged in.";
    return;
  }

  const name = document.getElementById("name").value.trim();
  const channel = document.getElementById("channel").value.trim();
  const platform = document.getElementById("platform").value;
  const description = document.getElementById("description").value.trim();

  if(!name || !channel || !platform){
    status.textContent = "Please fill all required fields.";
    return;
  }

  const { error } = await supabase.from("creators").insert({
    user_id: user.id,
    name,
    channel_url: channel,
    platform,
    description,
    is_live: true
  });

  if(error){
    status.textContent = error.message;
    return;
  }

  status.textContent = "Application submitted! Redirecting...";
  setTimeout(()=>location.href="index.html",1200);
};
</script>

</body>
</html>