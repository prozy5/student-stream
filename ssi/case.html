<!DOCTYPE html>
<html>
<head>
<title>SS:I Case File</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
<h2 id="title"></h2>
<p id="desc"></p>

<h3>Comments</h3>
<div id="comments"></div>

<textarea id="commentText"></textarea>
<button onclick="addComment()">Add Comment</button>
</div>

<script src="supabase.js"></script>
<script>

const id=new URLSearchParams(location.search).get("id");

async function loadCase(){
 const {data}=await supabase.from("cases").select("*").eq("id",id).single();
 title.innerText=data.title;
 desc.innerText=data.description;
}

async function loadComments(){
 const {data}=await supabase.from("comments").select("*").eq("video_id",id);
 const el=document.getElementById("comments");
 el.innerHTML="";
 data.forEach(c=>{
  el.innerHTML+=`<div class="card">${c.content}</div>`;
 });
}

async function addComment(){
 await supabase.from("comments").insert({
  video_id:id,
  content:commentText.value
 });
 commentText.value="";
 loadComments();
}

loadCase();
loadComments();

</script>
</body>
</html>